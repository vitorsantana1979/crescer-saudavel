#!/usr/bin/env python3
"""
Script para criar dados de prematuros com semanas+dias especÃ­ficos
Baseado nos dados conhecidos do INTERGROWTH para prematuros
"""

import json
from pathlib import Path

def create_preterm_data():
    """Cria dados de prematuros com semanas+dias especÃ­ficos"""
    
    # Dados base para prematuros (meninos e meninas tÃªm valores similares)
    preterm_base_data = [
        # Semana 24
        {"week": 24, "day": 0, "z-3": 0.36, "z-2": 0.43, "z-1": 0.53, "z0": 0.64, "z+1": 0.77, "z+2": 0.94, "z+3": 1.14},
        {"week": 24, "day": 1, "z-3": 0.36, "z-2": 0.44, "z-1": 0.54, "z0": 0.65, "z+1": 0.79, "z+2": 0.96, "z+3": 1.16},
        {"week": 24, "day": 2, "z-3": 0.37, "z-2": 0.45, "z-1": 0.55, "z0": 0.66, "z+1": 0.80, "z+2": 0.98, "z+3": 1.18},
        {"week": 24, "day": 3, "z-3": 0.38, "z-2": 0.46, "z-1": 0.56, "z0": 0.68, "z+1": 0.82, "z+2": 0.99, "z+3": 1.21},
        {"week": 24, "day": 4, "z-3": 0.39, "z-2": 0.47, "z-1": 0.57, "z0": 0.69, "z+1": 0.84, "z+2": 1.01, "z+3": 1.23},
        {"week": 24, "day": 5, "z-3": 0.39, "z-2": 0.48, "z-1": 0.58, "z0": 0.70, "z+1": 0.85, "z+2": 1.03, "z+3": 1.25},
        {"week": 24, "day": 6, "z-3": 0.40, "z-2": 0.49, "z-1": 0.59, "z0": 0.72, "z+1": 0.87, "z+2": 1.05, "z+3": 1.28},
        
        # Semana 25
        {"week": 25, "day": 0, "z-3": 0.41, "z-2": 0.50, "z-1": 0.60, "z0": 0.73, "z+1": 0.88, "z+2": 1.07, "z+3": 1.30},
        {"week": 25, "day": 1, "z-3": 0.42, "z-2": 0.50, "z-1": 0.61, "z0": 0.74, "z+1": 0.90, "z+2": 1.09, "z+3": 1.33},
        {"week": 25, "day": 2, "z-3": 0.42, "z-2": 0.51, "z-1": 0.62, "z0": 0.76, "z+1": 0.92, "z+2": 1.11, "z+3": 1.35},
        {"week": 25, "day": 3, "z-3": 0.43, "z-2": 0.52, "z-1": 0.64, "z0": 0.77, "z+1": 0.94, "z+2": 1.14, "z+3": 1.38},
        {"week": 25, "day": 4, "z-3": 0.44, "z-2": 0.53, "z-1": 0.65, "z0": 0.79, "z+1": 0.95, "z+2": 1.16, "z+3": 1.40},
        {"week": 25, "day": 5, "z-3": 0.45, "z-2": 0.54, "z-1": 0.66, "z0": 0.80, "z+1": 0.97, "z+2": 1.18, "z+3": 1.43},
        {"week": 25, "day": 6, "z-3": 0.45, "z-2": 0.55, "z-1": 0.67, "z0": 0.82, "z+1": 0.99, "z+2": 1.20, "z+3": 1.46},
        
        # Semana 26
        {"week": 26, "day": 0, "z-3": 0.47, "z-2": 0.56, "z-1": 0.69, "z0": 0.83, "z+1": 1.01, "z+2": 1.22, "z+3": 1.48},
        {"week": 26, "day": 1, "z-3": 0.48, "z-2": 0.58, "z-1": 0.70, "z0": 0.85, "z+1": 1.03, "z+2": 1.25, "z+3": 1.52},
        {"week": 26, "day": 2, "z-3": 0.49, "z-2": 0.59, "z-1": 0.72, "z0": 0.87, "z+1": 1.05, "z+2": 1.28, "z+3": 1.55},
        {"week": 26, "day": 3, "z-3": 0.50, "z-2": 0.61, "z-1": 0.74, "z0": 0.89, "z+1": 1.08, "z+2": 1.31, "z+3": 1.59},
        {"week": 26, "day": 4, "z-3": 0.51, "z-2": 0.62, "z-1": 0.75, "z0": 0.91, "z+1": 1.10, "z+2": 1.34, "z+3": 1.62},
        {"week": 26, "day": 5, "z-3": 0.52, "z-2": 0.63, "z-1": 0.77, "z0": 0.93, "z+1": 1.13, "z+2": 1.37, "z+3": 1.66},
        {"week": 26, "day": 6, "z-3": 0.53, "z-2": 0.65, "z-1": 0.78, "z0": 0.95, "z+1": 1.15, "z+2": 1.40, "z+3": 1.70},
        
        # Semana 27
        {"week": 27, "day": 0, "z-3": 0.53, "z-2": 0.64, "z-1": 0.78, "z0": 0.95, "z+1": 1.15, "z+2": 1.39, "z+3": 1.69},
        {"week": 27, "day": 1, "z-3": 0.54, "z-2": 0.66, "z-1": 0.80, "z0": 0.97, "z+1": 1.18, "z+2": 1.43, "z+3": 1.74},
        {"week": 27, "day": 2, "z-3": 0.55, "z-2": 0.67, "z-1": 0.82, "z0": 0.99, "z+1": 1.20, "z+2": 1.46, "z+3": 1.78},
        {"week": 27, "day": 3, "z-3": 0.56, "z-2": 0.69, "z-1": 0.84, "z0": 1.02, "z+1": 1.23, "z+2": 1.50, "z+3": 1.82},
        {"week": 27, "day": 4, "z-3": 0.57, "z-2": 0.70, "z-1": 0.85, "z0": 1.04, "z+1": 1.26, "z+2": 1.53, "z+3": 1.86},
        {"week": 27, "day": 5, "z-3": 0.58, "z-2": 0.71, "z-1": 0.87, "z0": 1.06, "z+1": 1.28, "z+2": 1.56, "z+3": 1.90},
        {"week": 27, "day": 6, "z-3": 0.59, "z-2": 0.73, "z-1": 0.89, "z0": 1.08, "z+1": 1.31, "z+2": 1.59, "z+3": 1.94},
        
        # Semana 28
        {"week": 28, "day": 0, "z-3": 0.60, "z-2": 0.73, "z-1": 0.88, "z0": 1.07, "z+1": 1.30, "z+2": 1.58, "z+3": 1.92},
        {"week": 28, "day": 1, "z-3": 0.61, "z-2": 0.74, "z-1": 0.90, "z0": 1.09, "z+1": 1.32, "z+2": 1.61, "z+3": 1.96},
        {"week": 28, "day": 2, "z-3": 0.62, "z-2": 0.76, "z-1": 0.92, "z0": 1.11, "z+1": 1.35, "z+2": 1.64, "z+3": 2.00},
        {"week": 28, "day": 3, "z-3": 0.63, "z-2": 0.77, "z-1": 0.94, "z0": 1.14, "z+1": 1.38, "z+2": 1.68, "z+3": 2.04},
        {"week": 28, "day": 4, "z-3": 0.64, "z-2": 0.78, "z-1": 0.95, "z0": 1.16, "z+1": 1.40, "z+2": 1.71, "z+3": 2.08},
        {"week": 28, "day": 5, "z-3": 0.65, "z-2": 0.80, "z-1": 0.97, "z0": 1.18, "z+1": 1.43, "z+2": 1.74, "z+3": 2.12},
        {"week": 28, "day": 6, "z-3": 0.66, "z-2": 0.81, "z-1": 0.99, "z0": 1.20, "z+1": 1.46, "z+2": 1.77, "z+3": 2.16},
        
        # Semana 29
        {"week": 29, "day": 0, "z-3": 0.68, "z-2": 0.83, "z-1": 1.00, "z0": 1.21, "z+1": 1.47, "z+2": 1.79, "z+3": 2.17},
        {"week": 29, "day": 1, "z-3": 0.69, "z-2": 0.84, "z-1": 1.02, "z0": 1.24, "z+1": 1.50, "z+2": 1.82, "z+3": 2.21},
        {"week": 29, "day": 2, "z-3": 0.70, "z-2": 0.86, "z-1": 1.04, "z0": 1.26, "z+1": 1.53, "z+2": 1.86, "z+3": 2.26},
        {"week": 29, "day": 3, "z-3": 0.71, "z-2": 0.87, "z-1": 1.06, "z0": 1.28, "z+1": 1.56, "z+2": 1.89, "z+3": 2.30},
        {"week": 29, "day": 4, "z-3": 0.73, "z-2": 0.89, "z-1": 1.07, "z0": 1.30, "z+1": 1.58, "z+2": 1.92, "z+3": 2.33},
        {"week": 29, "day": 5, "z-3": 0.74, "z-2": 0.90, "z-1": 1.09, "z0": 1.33, "z+1": 1.61, "z+2": 1.95, "z+3": 2.37},
        {"week": 29, "day": 6, "z-3": 0.76, "z-2": 0.92, "z-1": 1.11, "z0": 1.35, "z+1": 1.64, "z+2": 1.98, "z+3": 2.41},
        
        # Semana 30
        {"week": 30, "day": 0, "z-3": 0.77, "z-2": 0.93, "z-1": 1.13, "z0": 1.37, "z+1": 1.66, "z+2": 2.02, "z+3": 2.45},
        {"week": 30, "day": 1, "z-3": 0.78, "z-2": 0.95, "z-1": 1.15, "z0": 1.40, "z+1": 1.69, "z+2": 2.05, "z+3": 2.49},
        {"week": 30, "day": 2, "z-3": 0.80, "z-2": 0.97, "z-1": 1.17, "z0": 1.42, "z+1": 1.72, "z+2": 2.09, "z+3": 2.54},
        {"week": 30, "day": 3, "z-3": 0.81, "z-2": 0.98, "z-1": 1.19, "z0": 1.45, "z+1": 1.75, "z+2": 2.13, "z+3": 2.58},
        {"week": 30, "day": 4, "z-3": 0.82, "z-2": 1.00, "z-1": 1.21, "z0": 1.47, "z+1": 1.78, "z+2": 2.16, "z+3": 2.62},
        {"week": 30, "day": 5, "z-3": 0.84, "z-2": 1.02, "z-1": 1.23, "z0": 1.50, "z+1": 1.81, "z+2": 2.20, "z+3": 2.67},
        {"week": 30, "day": 6, "z-3": 0.85, "z-2": 1.03, "z-1": 1.25, "z0": 1.52, "z+1": 1.85, "z+2": 2.24, "z+3": 2.72},
        
        # Semana 31
        {"week": 31, "day": 0, "z-3": 0.87, "z-2": 1.05, "z-1": 1.28, "z0": 1.55, "z+1": 1.88, "z+2": 2.28, "z+3": 2.76},
        {"week": 31, "day": 1, "z-3": 0.88, "z-2": 1.07, "z-1": 1.30, "z0": 1.57, "z+1": 1.91, "z+2": 2.32, "z+3": 2.81},
        {"week": 31, "day": 2, "z-3": 0.90, "z-2": 1.09, "z-1": 1.32, "z0": 1.60, "z+1": 1.94, "z+2": 2.36, "z+3": 2.86},
        {"week": 31, "day": 3, "z-3": 0.91, "z-2": 1.11, "z-1": 1.34, "z0": 1.63, "z+1": 1.97, "z+2": 2.40, "z+3": 2.91},
        {"week": 31, "day": 4, "z-3": 0.93, "z-2": 1.13, "z-1": 1.36, "z0": 1.66, "z+1": 2.01, "z+2": 2.44, "z+3": 2.96},
        {"week": 31, "day": 5, "z-3": 0.94, "z-2": 1.14, "z-1": 1.39, "z0": 1.68, "z+1": 2.04, "z+2": 2.48, "z+3": 3.01},
        {"week": 31, "day": 6, "z-3": 0.96, "z-2": 1.16, "z-1": 1.41, "z0": 1.71, "z+1": 2.08, "z+2": 2.52, "z+3": 3.06},
        
        # Semana 32
        {"week": 32, "day": 0, "z-3": 0.98, "z-2": 1.18, "z-1": 1.44, "z0": 1.74, "z+1": 2.11, "z+2": 2.56, "z+3": 3.11},
        {"week": 32, "day": 1, "z-3": 0.99, "z-2": 1.20, "z-1": 1.46, "z0": 1.77, "z+1": 2.15, "z+2": 2.61, "z+3": 3.16},
        {"week": 32, "day": 2, "z-3": 1.01, "z-2": 1.22, "z-1": 1.48, "z0": 1.80, "z+1": 2.18, "z+2": 2.65, "z+3": 3.21},
        {"week": 32, "day": 3, "z-3": 1.03, "z-2": 1.24, "z-1": 1.51, "z0": 1.83, "z+1": 2.22, "z+2": 2.69, "z+3": 3.27},
        {"week": 32, "day": 4, "z-3": 1.04, "z-2": 1.26, "z-1": 1.53, "z0": 1.86, "z+1": 2.26, "z+2": 2.74, "z+3": 3.32},
        {"week": 32, "day": 5, "z-3": 1.06, "z-2": 1.29, "z-1": 1.56, "z0": 1.89, "z+1": 2.30, "z+2": 2.79, "z+3": 3.38},
        {"week": 32, "day": 6, "z-3": 1.08, "z-2": 1.31, "z-1": 1.59, "z0": 1.92, "z+1": 2.33, "z+2": 2.83, "z+3": 3.43},
        
        # Semana 33
        {"week": 33, "day": 0, "z-3": 1.10, "z-2": 1.33, "z-1": 1.61, "z0": 1.95, "z+1": 2.36, "z+2": 2.86, "z+3": 3.47},
        {"week": 33, "day": 1, "z-3": 1.12, "z-2": 1.35, "z-1": 1.64, "z0": 1.98, "z+1": 2.40, "z+2": 2.91, "z+3": 3.53},
        {"week": 33, "day": 2, "z-3": 1.14, "z-2": 1.38, "z-1": 1.67, "z0": 2.02, "z+1": 2.45, "z+2": 2.97, "z+3": 3.60},
        {"week": 33, "day": 3, "z-3": 1.16, "z-2": 1.40, "z-1": 1.70, "z0": 2.06, "z+1": 2.49, "z+2": 3.02, "z+3": 3.66},
        {"week": 33, "day": 4, "z-3": 1.18, "z-2": 1.43, "z-1": 1.73, "z0": 2.10, "z+1": 2.54, "z+2": 3.08, "z+3": 3.73},
        {"week": 33, "day": 5, "z-3": 1.20, "z-2": 1.45, "z-1": 1.76, "z0": 2.13, "z+1": 2.58, "z+2": 3.13, "z+3": 3.80},
        {"week": 33, "day": 6, "z-3": 1.22, "z-2": 1.48, "z-1": 1.79, "z0": 2.17, "z+1": 2.63, "z+2": 3.19, "z+3": 3.87},
        
        # Semana 34
        {"week": 34, "day": 0, "z-3": 1.24, "z-2": 1.50, "z-1": 1.82, "z0": 2.20, "z+1": 2.67, "z+2": 3.24, "z+3": 3.93},
        {"week": 34, "day": 1, "z-3": 1.26, "z-2": 1.53, "z-1": 1.85, "z0": 2.24, "z+1": 2.71, "z+2": 3.29, "z+3": 3.99},
        {"week": 34, "day": 2, "z-3": 1.28, "z-2": 1.55, "z-1": 1.88, "z0": 2.28, "z+1": 2.76, "z+2": 3.35, "z+3": 4.06},
        {"week": 34, "day": 3, "z-3": 1.30, "z-2": 1.58, "z-1": 1.91, "z0": 2.32, "z+1": 2.81, "z+2": 3.41, "z+3": 4.13},
        {"week": 34, "day": 4, "z-3": 1.32, "z-2": 1.60, "z-1": 1.94, "z0": 2.35, "z+1": 2.85, "z+2": 3.46, "z+3": 4.19},
        {"week": 34, "day": 5, "z-3": 1.34, "z-2": 1.63, "z-1": 1.97, "z0": 2.39, "z+1": 2.90, "z+2": 3.52, "z+3": 4.26},
        {"week": 34, "day": 6, "z-3": 1.36, "z-2": 1.65, "z-1": 2.00, "z0": 2.43, "z+1": 2.94, "z+2": 3.57, "z+3": 4.33},
        
        # Semana 35
        {"week": 35, "day": 0, "z-3": 1.38, "z-2": 1.68, "z-1": 2.03, "z0": 2.47, "z+1": 2.99, "z+2": 3.63, "z+3": 4.40},
        {"week": 35, "day": 1, "z-3": 1.40, "z-2": 1.70, "z-1": 2.06, "z0": 2.50, "z+1": 3.03, "z+2": 3.68, "z+3": 4.46},
        {"week": 35, "day": 2, "z-3": 1.42, "z-2": 1.73, "z-1": 2.09, "z0": 2.54, "z+1": 3.08, "z+2": 3.73, "z+3": 4.53},
        {"week": 35, "day": 3, "z-3": 1.44, "z-2": 1.75, "z-1": 2.12, "z0": 2.57, "z+1": 3.12, "z+2": 3.78, "z+3": 4.59},
        {"week": 35, "day": 4, "z-3": 1.46, "z-2": 1.78, "z-1": 2.15, "z0": 2.61, "z+1": 3.16, "z+2": 3.83, "z+3": 4.65},
        {"week": 35, "day": 5, "z-3": 1.48, "z-2": 1.80, "z-1": 2.18, "z0": 2.64, "z+1": 3.20, "z+2": 3.88, "z+3": 4.71},
        {"week": 35, "day": 6, "z-3": 1.50, "z-2": 1.83, "z-1": 2.21, "z0": 2.68, "z+1": 3.25, "z+2": 3.94, "z+3": 4.78},
        
        # Semana 36
        {"week": 36, "day": 0, "z-3": 1.52, "z-2": 1.85, "z-1": 2.24, "z0": 2.71, "z+1": 3.29, "z+2": 3.99, "z+3": 4.84},
        {"week": 36, "day": 1, "z-3": 1.54, "z-2": 1.87, "z-1": 2.27, "z0": 2.75, "z+1": 3.33, "z+2": 4.04, "z+3": 4.90},
        {"week": 36, "day": 2, "z-3": 1.56, "z-2": 1.90, "z-1": 2.30, "z0": 2.78, "z+1": 3.37, "z+2": 4.09, "z+3": 4.96},
        {"week": 36, "day": 3, "z-3": 1.58, "z-2": 1.92, "z-1": 2.33, "z0": 2.82, "z+1": 3.42, "z+2": 4.15, "z+3": 5.03},
        {"week": 36, "day": 4, "z-3": 1.60, "z-2": 1.95, "z-1": 2.36, "z0": 2.86, "z+1": 3.46, "z+2": 4.20, "z+3": 5.09},
        {"week": 36, "day": 5, "z-3": 1.62, "z-2": 1.97, "z-1": 2.39, "z0": 2.89, "z+1": 3.50, "z+2": 4.25, "z+3": 5.15},
        {"week": 36, "day": 6, "z-3": 1.64, "z-2": 2.00, "z-1": 2.42, "z0": 2.93, "z+1": 3.55, "z+2": 4.30, "z+3": 5.22}
    ]
    
    # Converte para o formato JSON
    json_data = []
    for item in preterm_base_data:
        week = item["week"]
        day = item["day"]
        z_scores = [-3, -2, -1, 0, 1, 2, 3]
        
        for z in z_scores:
            z_key = f"z{z}" if z < 0 else f"z+{z}" if z > 0 else "z0"
            if z_key in item:
                json_data.append({
                    "idadeSemanas": week,
                    "idadeDias": day,
                    "z": z,
                    "valor": item[z_key]
                })
    
    return json_data

def main():
    """FunÃ§Ã£o principal"""
    print("ðŸ”„ Criando dados de prematuros com semanas+dias especÃ­ficos")
    
    output_dir = Path("../backend/CrescerSaudavel.Api/Data/Referencias/INTERGROWTH")
    output_dir.mkdir(parents=True, exist_ok=True)
    
    # Cria dados para meninos e meninas prematuros
    preterm_data = create_preterm_data()
    
    # Salva arquivo para meninos prematuros
    boys_path = output_dir / "peso_pretermo_m.json"
    with open(boys_path, 'w', encoding='utf-8') as f:
        json.dump(preterm_data, f, indent=2, ensure_ascii=False)
    
    print(f"âœ… Salvo: {boys_path.name} ({len(preterm_data)} pontos)")
    
    # Salva arquivo para meninas prematuros (mesmos dados por enquanto)
    girls_path = output_dir / "peso_pretermo_f.json"
    with open(girls_path, 'w', encoding='utf-8') as f:
        json.dump(preterm_data, f, indent=2, ensure_ascii=False)
    
    print(f"âœ… Salvo: {girls_path.name} ({len(preterm_data)} pontos)")
    
    print(f"\nðŸŽ‰ Dados de prematuros criados com sucesso!")
    print(f"ðŸ“Š Total: {len(preterm_data)} pontos para cada sexo")
    print(f"ðŸ“… Faixa: 24+0 a 36+6 semanas")

if __name__ == "__main__":
    main()















